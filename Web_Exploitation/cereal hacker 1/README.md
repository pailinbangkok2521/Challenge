# cereal hacker 1
Points: 450
## Category
Web Exploitation
## Problem Statement
> Login as admin. https://2019shell1.picoctf.com/problem/37889/ or http://2019shell1.picoctf.com:37889
## Solution
We have to start off with some guess work here. Upon opening this page, we see a username and password field. If we put in username: `guest` and password: `guest`, we get in to a page called `https://2019shell1.picoctf.com/problem/37889/index.php?file=regular_user` with nothing significant besides welcome page. We can try to access `index.php?file=admin`, but the page is blocked. When we look at the cookies, we can see a user_info cookie set to `TzoxMToicGVybWlzc2lvbnMiOjI6e3M6ODoidXNlcm5hbWUiO3M6NToiZ3Vlc3QiO3M6ODoicGFzc3dvcmQiO3M6NToiZ3Vlc3QiO30%253D`. A jumble of characters may signify base64, so when we decode it with a base64 decoder, we see that it is actually a serialized php object: `O:11:"permissions":2:{s:8:"username";s:5:"guest";s:8:"password";s:5:"guest";}6p`. The way that serialized data in php works is as so: The first character 'O' represents object, which is the type of data it is. The next number '11' tells us how many characters the name of the object is. Followed by that is the name of the object, 'permissions'. Then next number '2' is how many attributes are in the object. Each 's' represents that the data type is a string and each number represents how many characters the name or value is. It is very important that these numbers correlate with the values. 'username' has 8 characters, 'guest' has 5 characters, and so forth. We can then put in a simple SQL Injection (while using the correct numbers) as so: `O:11:"permissions":2:{s:8:"username";s:16:"admin' or '1'='1";s:8:"password";s:0:"";}6p`. Note that I set the legnth to 16, as that is the length of the string "admin' or '1'='1". Encode this back to base64, insert it as the user_info cookie, and open the `index.php?file=admin` page at `https://2019shell1.picoctf.com/problem/37889/index.php?file=admin`. There, you will see your flag.
## Flag
picoCTF{5a1aa7dfd74a9b67bc5844b8245c9d2e}